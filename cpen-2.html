<html>
<head>
    <title>JavaScript Calculator by Eugene Shashkov</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" type="text/css" href="lib/css/some_awesome_style_by_my_best_imagination.css">
	<link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap-theme.css">
    <link rel="stylesheet" type="text/css" href="lib/css/fonts/Comfortaa-Bold.ttf">
    <link rel="stylesheet" type="text/css" href="lib/css/fonts/Comfortaa-Regular.ttf">
  <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
 
  
  </head>
    <body style="-webkit-font-smoothing:antialiased;">
	<div class="back">
<div   class="result">
        <div   class="result_text">
            <div id="result"  class="numbers_to_show ds"></div>
		</div>
    </div>
    <div class="main_position">
<div class="cent">
        <div  class="flo_l">
            <a onclick="getElementById('result').innerHTML=some_math(1)" id="b1" class="btn-size btn btn-lg btn-outline btn-default comfortaa">1</a>
            <a onclick="getElementById('result').innerHTML=some_math(2)" id="b2" class="btn-size btn btn-lg btn-outline btn-default comfortaa ">2</a>
            <a onclick="getElementById('result').innerHTML=some_math(3);" id="b3" class="btn-size btn btn-lg btn-outline btn-default comfortaa">3</a>
            <br>
            <a onclick="getElementById('result').innerHTML=some_math(4);" id="b4" class="btn-size btn btn-lg btn-outline btn-default comfortaa">4</a>
            <a onclick="getElementById('result').innerHTML=some_math(5);" id="b5" class="btn-size btn btn-lg btn-outline btn-default comfortaa">5</a>
            <a onclick="getElementById('result').innerHTML=some_math(6);" id="b6" class="btn-size btn btn-lg btn-outline btn-default comfortaa">6</a>
            <br>
            <a onclick="getElementById('result').innerHTML=some_math(7);" id="b7" class="btn-size btn btn-lg btn-outline btn-default comfortaa">7</a>
            <a onclick="getElementById('result').innerHTML=some_math(8);" id="b8" class="btn-size btn btn-lg btn-outline btn-default comfortaa">8</a>
            <a onclick="getElementById('result').innerHTML=some_math(9);" id="b9" class="btn-size btn btn-lg btn-outline btn-default comfortaa">9</a>
            <br>
            <a onclick="getElementById('result').innerHTML=some_math(0);" id="b0" class="btn-size btn btn-lg btn-outline btn-default comfortaa">0</a>
            <a onclick="getElementById('result').innerHTML=point_pressed();" class="btn-size btn btn-lg btn-outline btn-default comfortaa">.</a>
			<a onclick="getElementById('result').innerHTML=equal();" class="btn-size btn btn-lg btn-outline btn-default comfortaa">=</a>
        </div>



    <div class="second_bloc">
    <a onclick="getElementById('result').innerHTML=reset_this_up();" class="reset btn btn-lg btn-outline btn-default comfortaa ">reset</a><br>
    </div>
    <div class="third_bloc">
        <a onclick="getElementById('result').innerHTML=some_math_operations('+');" class="plus btn btn-lg btn-outline btn-default comfortaa " >+</a>


        <a onclick="getElementById('result').innerHTML=some_math_operations('-');" class="btn-size btn btn-lg btn-outline btn-default comfortaa">-</a>
        </div>
<div class="fourth_bloc">
    <a onclick="getElementById('result').innerHTML=some_math_operations('*');" class="btn-size btn btn-lg btn-outline btn-default comfortaa">*</a><br>

    <a onclick="getElementById('result').innerHTML=some_math_operations('/');" class="btn-size btn btn-lg btn-outline btn-default comfortaa">/</a><br>
    <a onclick="getElementById('result').innerHTML=some_root();" class="btn-size btn btn-lg btn-outline btn-default comfortaa ">âˆš</a><br>
</div>
</div>

      <div class="by_e_s"><a href="https://github.com/fonjeekay/JS-calculator-5_22_2015" target="_blank">by Eugene Shashkov</a></div>
    </div>
</div>


    <!--logic of the operations-->
	<script src="lib/js/logic.js">
        var sign,some_key,result=0,gime_some_num,str_length,str_of_last_symbol,str_of_current_symbol,equal_done=false,ok_eval=false,i2=0,times_of_operations_pressed=0,point_once=0;



//////// some point helper variable
var a;
var last_some_plus_minus_char=false;
var last_point_place=false;
var string_to_test=false;
var some_point_variable_1;
///// if program just started result=0 ...
var test_eval;
console.log('Calculator v1.03 by Eugene Shashkov');


window.onload=function(){
    zero_to_result();
}


var zero_on_start=document.getElementById('result');
function zero_to_result(){
 zero_on_start.innerHTML='0';
}



function result_zero(gime_some_num){
    if(gime_some_num===0) {return true;} else {return false;}  ///// ??? 3-? ????? 0. = 0  /// without ===    case  ('0.'=0) bug fixed
    console.log('result_zero is ok');
}



////////////////// if = was pressed already
////// to remove string + number 1 2 3 4 5 6 7.... //// now its result=0 ...means its ready to new operations
function if_equal_done(){
    if(equal_done==true){
        result=0;
        equal_done=false;
        return result;
    }
}



///// 1 2 3 4 5 6 7 8 9 to string

function some_math(some_key){

    if_equal_done();                            ///// if '=' was pressed in past then result=0

    if(result_zero(result)==true){
        result=some_key;
        console.log('some_math part 1 ');           ///// CONSOLE
    } else {
        result=String(result)+String(some_key);
        console.log('some_math part 2 ');           ///// CONSOLE
    }

    console.log('some_math going to return ');  ///// CONSOLE

    return result;
}





//////////////// point helpers


function parse_all_symbols(){

    str_of_last_symbol=result.slice(-1);
    console.log(' last symbol = '+str_of_last_symbol);
    console.log('length of the string = '+result.length);

    for(var i=1;i<=result.length;i++){
        a=(result.length-i);
        str_of_current_symbol=result.charAt(a);
        console.log(' current symbool = '+ str_of_current_symbol);

        if(str_of_current_symbol=='+' || str_of_current_symbol=='-'
            || str_of_current_symbol=='*' || str_of_current_symbol=='/'){
            last_some_plus_minus_char=a;
            break;
        }
        console.log(' str_of_current_symbol = '+str_of_current_symbol);

        if(str_of_current_symbol=='.'){
            last_point_place=a;
        }
        /////////// here we can do something with our string
    }


    ///////// string to test
    string_to_test=result.substring(last_some_plus_minus_char, result.length);
    console.log(' string_to_test = '+string_to_test);
    /////////// 85.
    if(last_some_plus_minus_char===false && last_point_place==false){
        result=String(result)+'.';
        return result;
    }
    /////85.98+87
    if(last_some_plus_minus_char!==false && last_point_place===false){
        result=String(result)+'.';
        return result;
    }
}

//////////////////////////  POINT   ///////////////////////////////////////////
function point_pressed(){



    console.log('point pressed');

    if(equal_done==true){
        return result;
    }

    ////////// need always convert result into string if we check it like a string!!!!!!!!!!!!!!!
    result=String(result);
    str_of_last_symbol=result.slice(-1);
    if(str_of_last_symbol=='.'){
        return result;
    }

    if(str_of_last_symbol!='+' && str_of_last_symbol!='-' && str_of_last_symbol!='*' && str_of_last_symbol!='/' ){



        ////// ?????can be some parse code here, nothing special now :)

        console.log(' simple part is working ');
        parse_all_symbols();

    }
    return result;
}


function some_root(){

    var first_char;
    if (result.length>1){
        first_char=result.substring(0, 1);
    }else first_char=result;

    if(times_of_operations_pressed<1 && first_char!='-'){
        result=Math.sqrt(result);
    }else {
        equal(); /////////////////// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        result=Math.sqrt(result);
    }

    return result;
}





//// M A T H    O P E R A T I O N S      ////////////////
function some_math_operations(sign){
    result=String(result);
    str_of_last_symbol=result.slice(-1);
    if(str_of_last_symbol=='.'){
        result.slice(0,-1);
        point_once=0;
        return result;
    }
    times_of_operations_pressed++;
    equal_done=false;
    console.log('Math operations started ');   ///// CONSOLE
    if(result=='0'){
        if(sign=='-'){
            result='-';
            return result; //// if result=0 and '-' button is pressed, we change '0' to '-' which is equal but first case is not appropriate
        }
        console.log('Math point 1 ');
        result='0'+String(sign);
        return result;}else {

        if(result.length>=2){
            console.log('Math point 2 ');
            str_of_last_symbol=result.slice(-1);//// crop the last symbol to some variable
        }
        if(str_of_last_symbol=='+' || str_of_last_symbol=='-' || str_of_last_symbol=='*' || str_of_last_symbol=='/'){
            console.log('Math point 3 ');
            result=result.substring(0, result.length - 1);   /////  delete last symbol
        }                                                /////  and place our symbol what we need
        result=String(result)+String(sign);
    }
    console.log('Math point string is ready!  << - - Math is return some result - - >> ');
    return result;
}



function ready_to_val(){
    console.log('ready to wal is Working');
    var sub1=0;
    var sub2=1;

    var one_number_exist=false;
    var few_numbers_exists=false;
    while (sub2<=result.length){
        str_of_current_symbol=result.substring(sub1,sub2);

        if(str_of_current_symbol=='+' || str_of_current_symbol=='-' ||
            str_of_current_symbol=='*' || str_of_current_symbol=='/'){
            console.log(sub2+ ' sub 2 ' );
            if(sub2>=2 && (result.length-sub2)>0){
                return true;}}
        sub1++;
        sub2++;}}


//////  == helper

function go_or_return(){
    test_eval=eval(result);
    if(result==test_eval)return result;
}

////////// = = = = = = =  /////////////////////
function equal(){
    go_or_return();
    times_of_operations_pressed=0;
    console.log('eval begin... result =' + result);
    if(result!=0 && result.length>1 && result!='+' && result!='-' && result!='*' && result!='/'){
        ////////////////// Uncaught SyntaxError: Unexpected end of input (to give it away we need to do next if)
        if(result.length>=2){
            console.log('Math point 2 ');





            str_of_last_symbol=result.slice(-1);
            if(str_of_last_symbol=='+' || str_of_last_symbol=='-'
                || str_of_last_symbol=='*' || str_of_last_symbol=='/' || str_of_last_symbol==='.'){
                result=result.substring(0, result.length - 1);} ///// delete last symbol if its don't needed

            console.log('< - - E V A L - - >');

            var check_ready_to_val=ready_to_val();

            console.log(' check_ready_to_val '+check_ready_to_val);

            if(check_ready_to_val==true){

                console.log('ready to wal is true ');
                console.log('result = '+ result);
                ////////!!!!!!!!!!!!!!!!!!!!!!!!!!!

                /// point variables to false


                last_some_plus_minus_char=false;
                last_point_place=false;
                string_to_test=false;



                result=eval(result);             //////////////////////////    the main thing
                console.log('result = '+ result);
            }

            equal_done=true;               //////////// !!!!!!!!!!!!!!
            if(result!='undefined'){
                return result;
            }else return 'try again';

        }
    }else {
        equal_done=true;       /////// !!!!!!!!!!!!!!!!!!!
        console.log('equal last part result=  '+ result);
        return result;} ;
}


//////  R E S E T /////////
  function reset_this_up(){
      equal_done=false;
      result=0;
      last_some_plus_minus_char=false;
      last_point_place=false;
      string_to_test=false;
      return result;
}




    </script>
    </body>
    </html>
